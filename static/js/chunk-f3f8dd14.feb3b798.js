(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f3f8dd14"],{"0371":function(e,r,t){"use strict";t("9833")},9833:function(e,r,t){},aef7:function(e,r,t){"use strict";t.r(r);var n=t("7a23"),a=Object(n["withScopeId"])("data-v-15a3c61a");Object(n["pushScopeId"])("data-v-15a3c61a");var o={class:"change-password-container"},c=Object(n["createTextVNode"])("提交修改"),u=Object(n["createTextVNode"])("重置");Object(n["popScopeId"])();var s=a((function(e,r,t,s,l,i){var d=Object(n["resolveComponent"])("a-input-password"),p=Object(n["resolveComponent"])("a-form-item"),b=Object(n["resolveComponent"])("a-button"),f=Object(n["resolveComponent"])("a-space"),m=Object(n["resolveComponent"])("a-form");return Object(n["openBlock"])(),Object(n["createBlock"])("div",o,[Object(n["createVNode"])(m,{ref:"submitForm",model:s.form,rules:s.rules,"label-col":{span:s.labelColSpan},"wrapper-col":{span:s.wrapperColSpan}},{default:a((function(){return[Object(n["createVNode"])(p,{label:"旧密码",name:"oldPassword"},{default:a((function(){return[Object(n["createVNode"])(d,{value:s.form.oldPassword,"onUpdate:value":r[1]||(r[1]=function(e){return s.form.oldPassword=e}),placeholder:"请输入旧密码",onKeyup:Object(n["withKeys"])(s.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(n["createVNode"])(p,{label:"新密码",name:"newPassword"},{default:a((function(){return[Object(n["createVNode"])(d,{value:s.form.newPassword,"onUpdate:value":r[2]||(r[2]=function(e){return s.form.newPassword=e}),placeholder:"请输入新密码",onKeyup:Object(n["withKeys"])(s.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(n["createVNode"])(p,{label:"确认密码",name:"rePassword"},{default:a((function(){return[Object(n["createVNode"])(d,{value:s.form.rePassword,"onUpdate:value":r[3]||(r[3]=function(e){return s.form.rePassword=e}),placeholder:"请输入确认密码",onKeyup:Object(n["withKeys"])(s.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(n["createVNode"])(p,{"wrapper-col":{span:s.wrapperColSpan,offset:s.labelColSpan}},{default:a((function(){return[Object(n["createVNode"])(f,{size:"small"},{default:a((function(){return[Object(n["createVNode"])(b,{type:"primary",onClick:s.onSubmit,loading:s.submitLoading},{default:a((function(){return[c]})),_:1},8,["onClick","loading"]),Object(n["createVNode"])(b,{onClick:s.handleResetForm},{default:a((function(){return[u]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["wrapper-col"])]})),_:1},8,["model","rules","label-col","wrapper-col"])])})),l=(t("d3b7"),t("96cf"),t("1da1")),i=t("f64c"),d=t("8c1b"),p=t("61f7"),b=t("fab2"),f={name:"ChangePassword",setup:function(){var e=Object(d["a"])(),r=e.store,t=e.router,a=Object(n["computed"])((function(){return r.getters.token})),o=6,c=18,u=Object(n["reactive"])({oldPassword:"",newPassword:"",rePassword:""}),s=function(e,r){return r?Object(p["g"])(r)?Promise.resolve():Promise.reject("密码中必须包含字母、数字，长度至少为6个字符！"):Promise.reject("请输入新密码")},f=function(e,r){return r?Object(p["a"])(r,u.newPassword)?Promise.resolve():Promise.reject("两次输入密码不一致"):Promise.reject("请输入确认密码")},m=Object(n["reactive"])({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,validator:s,trigger:"blur"}],rePassword:[{required:!0,validator:f,trigger:"blur"}]}),w=Object(n["ref"])(!1),v=Object(n["ref"])(null),j=function(){v.value.validate().then(Object(l["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=Object(n["toRaw"])(u),o.oldPassword!=o.newPassword){e.next=4;break}return i["a"].error("旧密码和新密码不能相同！"),e.abrupt("return",!1);case 4:w.value=!0,b["a"].ChangePwd(o,a.value).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(n){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=n.code,o=n.msg,200!=a){e.next=17;break}return e.prev=2,e.next=5,r.dispatch("user/logout");case 5:return e.next=7,r.dispatch("permission/generateRoutes",null);case 7:i["a"].success("密码修改成功!请重新登录"),t.push({name:"Home"}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),console.log(e.t0),t.push({name:"Home"});case 15:e.next=18;break;case 17:404==a?i["a"].warning(o):i["a"].error("密码修改失败！");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){return i["a"].error(e.error)})).finally((function(){return w.value=!1}));case 6:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("error",e)}))},O=function(){v.value.resetFields()};return{labelColSpan:o,wrapperColSpan:c,form:u,rules:m,submitLoading:w,onSubmit:j,handleResetForm:O,submitForm:v}}};t("0371");f.render=s,f.__scopeId="data-v-15a3c61a";r["default"]=f}}]);