(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c1dba69"],{7901:function(e,r,t){"use strict";t("fcd9")},aef7:function(e,r,t){"use strict";t.r(r);var n=t("7a23"),o=Object(n["withScopeId"])("data-v-e9faedfc");Object(n["pushScopeId"])("data-v-e9faedfc");var a={class:"change-password-container"},c=Object(n["createTextVNode"])("提交修改"),u=Object(n["createTextVNode"])("重置");Object(n["popScopeId"])();var s=o((function(e,r,t,s,l,d){var i=Object(n["resolveComponent"])("a-input-password"),p=Object(n["resolveComponent"])("a-form-item"),f=Object(n["resolveComponent"])("a-button"),b=Object(n["resolveComponent"])("a-space"),m=Object(n["resolveComponent"])("a-form");return Object(n["openBlock"])(),Object(n["createBlock"])("div",a,[Object(n["createVNode"])(m,{ref:"submitForm",model:s.form,rules:s.rules,"label-col":{span:s.labelColSpan},"wrapper-col":{span:s.wrapperColSpan}},{default:o((function(){return[Object(n["createVNode"])(p,{label:"旧密码",name:"oldPassword"},{default:o((function(){return[Object(n["createVNode"])(i,{value:s.form.oldPassword,"onUpdate:value":r[1]||(r[1]=function(e){return s.form.oldPassword=e}),placeholder:"请输入旧密码",onKeyup:Object(n["withKeys"])(s.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(n["createVNode"])(p,{label:"新密码",name:"newPassword"},{default:o((function(){return[Object(n["createVNode"])(i,{value:s.form.newPassword,"onUpdate:value":r[2]||(r[2]=function(e){return s.form.newPassword=e}),placeholder:"请输入新密码",onKeyup:Object(n["withKeys"])(s.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(n["createVNode"])(p,{label:"确认密码",name:"rePassword"},{default:o((function(){return[Object(n["createVNode"])(i,{value:s.form.rePassword,"onUpdate:value":r[3]||(r[3]=function(e){return s.form.rePassword=e}),placeholder:"请输入确认密码",onKeyup:Object(n["withKeys"])(s.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(n["createVNode"])(p,{"wrapper-col":{span:s.wrapperColSpan,offset:s.labelColSpan}},{default:o((function(){return[Object(n["createVNode"])(b,{size:"small"},{default:o((function(){return[Object(n["createVNode"])(f,{type:"primary",onClick:s.onSubmit,loading:s.submitLoading},{default:o((function(){return[c]})),_:1},8,["onClick","loading"]),Object(n["createVNode"])(f,{onClick:s.handleResetForm},{default:o((function(){return[u]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["wrapper-col"])]})),_:1},8,["model","rules","label-col","wrapper-col"])])})),l=(t("d3b7"),t("96cf"),t("1da1")),d=t("f64c"),i=t("8c1b"),p=t("61f7"),f=t("fab2"),b={name:"ChangePassword",setup:function(){var e=Object(i["a"])(),r=e.store,t=e.router,o=Object(n["computed"])((function(){return r.getters.token})),a=6,c=18,u=Object(n["ref"])(!1),s=Object(n["ref"])(null),b=Object(n["reactive"])({oldPassword:"",newPassword:"",rePassword:""}),m=function(e,r){return r?Object(p["g"])(r)?Promise.resolve():Promise.reject("密码中必须包含字母、数字，长度至少为6个字符！"):Promise.reject("请输入新密码")},w=function(e,r){return r?Object(p["a"])(r,b.newPassword)?Promise.resolve():Promise.reject("两次输入密码不一致"):Promise.reject("请输入确认密码")},v=Object(n["reactive"])({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,validator:m,trigger:"blur"}],rePassword:[{required:!0,validator:w,trigger:"blur"}]}),j=function(){s.value.validate().then(Object(l["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=Object(n["toRaw"])(b),a.oldPassword!=a.newPassword){e.next=4;break}return d["a"].error("旧密码和新密码不能相同！"),e.abrupt("return",!1);case 4:u.value=!0,f["a"].ChangePwd(a,o.value).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(n){var o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=n.code,a=n.msg,200!=o){e.next=17;break}return e.prev=2,e.next=5,r.dispatch("user/logout");case 5:return e.next=7,r.dispatch("permission/generateRoutes",null);case 7:d["a"].success("密码修改成功!请重新登录"),t.push({name:"Home"}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),console.log(e.t0),t.push({name:"Home"});case 15:e.next=18;break;case 17:404==o?d["a"].warning(a):d["a"].error("密码修改失败！");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){return d["a"].error(e.error)})).finally((function(){return u.value=!1}));case 6:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("error",e)}))},O=function(){s.value.resetFields()};return{labelColSpan:a,wrapperColSpan:c,form:b,rules:v,submitLoading:u,onSubmit:j,handleResetForm:O,submitForm:s}}};t("7901");b.render=s,b.__scopeId="data-v-e9faedfc";r["default"]=b},fcd9:function(e,r,t){}}]);