(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74844531"],{"242e":function(e,r,t){},"90cd":function(e,r,t){"use strict";t("242e")},aef7:function(e,r,t){"use strict";t.r(r);var o=t("dbba"),n=Object(o["withScopeId"])("data-v-266dcd80");Object(o["pushScopeId"])("data-v-266dcd80");var a={class:"change-password-container"},c=Object(o["createTextVNode"])("提交修改"),s=Object(o["createTextVNode"])("重置");Object(o["popScopeId"])();var u=n((function(e,r){var t=Object(o["resolveComponent"])("a-input-password"),u=Object(o["resolveComponent"])("a-form-item"),l=Object(o["resolveComponent"])("a-button"),i=Object(o["resolveComponent"])("a-space"),d=Object(o["resolveComponent"])("a-form");return Object(o["openBlock"])(),Object(o["createBlock"])("div",a,[Object(o["createVNode"])(d,{ref:"submitForm",model:e.form,rules:e.rules,"label-col":{span:e.labelColSpan},"wrapper-col":{span:e.wrapperColSpan}},{default:n((function(){return[Object(o["createVNode"])(u,{label:"旧密码",name:"oldPassword"},{default:n((function(){return[Object(o["createVNode"])(t,{value:e.form.oldPassword,"onUpdate:value":r[1]||(r[1]=function(r){return e.form.oldPassword=r}),placeholder:"请输入旧密码",onKeyup:Object(o["withKeys"])(e.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(o["createVNode"])(u,{label:"新密码",name:"newPassword"},{default:n((function(){return[Object(o["createVNode"])(t,{value:e.form.newPassword,"onUpdate:value":r[2]||(r[2]=function(r){return e.form.newPassword=r}),placeholder:"请输入新密码",onKeyup:Object(o["withKeys"])(e.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(o["createVNode"])(u,{label:"确认密码",name:"rePassword"},{default:n((function(){return[Object(o["createVNode"])(t,{value:e.form.rePassword,"onUpdate:value":r[3]||(r[3]=function(r){return e.form.rePassword=r}),placeholder:"请输入确认密码",onKeyup:Object(o["withKeys"])(e.onSubmit,["enter"])},null,8,["value","onKeyup"])]})),_:1}),Object(o["createVNode"])(u,{"wrapper-col":{span:e.wrapperColSpan,offset:e.labelColSpan}},{default:n((function(){return[Object(o["createVNode"])(i,{size:"small"},{default:n((function(){return[Object(o["createVNode"])(l,{type:"primary",onClick:e.onSubmit,loading:e.submitLoading},{default:n((function(){return[c]})),_:1},8,["onClick","loading"]),Object(o["createVNode"])(l,{onClick:e.resetForm},{default:n((function(){return[s]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["wrapper-col"])]})),_:1},8,["model","rules","label-col","wrapper-col"])])})),l=(t("845c"),t("6a61"),t("2e91")),i=t("61f7"),d=t("fab2"),p={name:"ChangePassword",setup:function(){var e=Object(o["getCurrentInstance"])(),r=e.ctx,t=Object(o["computed"])((function(){return r.$store.getters.token})),n=6,a=18,c=Object(o["reactive"])({oldPassword:"",newPassword:"",rePassword:""}),s=function(e,r){return r?Object(i["g"])(r)?Promise.resolve():Promise.reject("密码中必须包含字母、数字，长度至少为6个字符！"):Promise.reject("请输入新密码")},u=function(e,r){return r?Object(i["a"])(r,c.newPassword)?Promise.resolve():Promise.reject("两次输入密码不一致"):Promise.reject("请输入确认密码")},p=Object(o["reactive"])({oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,validator:s,trigger:"blur"}],rePassword:[{required:!0,validator:u,trigger:"blur"}]}),b=Object(o["ref"])(!1),m=function(){r.$refs.submitForm.validate().then(Object(l["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(o["toRaw"])(c),n.oldPassword!=n.newPassword){e.next=4;break}return r.$message.error("旧密码和新密码不能相同！"),e.abrupt("return",!1);case 4:b.value=!0,d["a"].ChangePwd(n,t.value).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var o,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=t.code,n=t.msg,200!=o){e.next=17;break}return e.prev=2,e.next=5,r.$store.dispatch("user/logout");case 5:return e.next=7,r.$store.dispatch("permission/generateRoutes",null);case 7:r.$message.success("密码修改成功!请重新登录"),r.$router.push({name:"Home"}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),console.log(e.t0),r.$router.push({name:"Home"});case 15:e.next=18;break;case 17:404==o?r.$message.warning(n):r.$message.error("密码修改失败！");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){return r.$message.error(e.error)})).finally((function(){return b.value=!1}));case 6:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("error",e)}))},f=function(){r.$refs.submitForm.resetFields()};return{labelColSpan:n,wrapperColSpan:a,form:c,rules:p,submitLoading:b,onSubmit:m,resetForm:f}}};t("90cd");p.render=u,p.__scopeId="data-v-266dcd80";r["default"]=p}}]);